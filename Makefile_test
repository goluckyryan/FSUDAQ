########################################################################
#
#
#########################################################################

CC	=	g++

#COPTS	=	-fPIC -DLINUX -O2 -std=c++17 -lpthread
COPTS	=	-fPIC -DLINUX -g -O2 -Wall -std=c++17 -lpthread

CAENLIBS	=	-lCAENDigitizer

ROOTLIBS = `root-config --cflags --glibs`

OBJS = ClassDigitizer.o OnlineEventBuilder.o MultiBuilder.o

ALL = test test_indep EventBuilder DataGenerator EventKenshikushi

#########################################################################

all	:	$(ALL)

clean	:
		/bin/rm -f $(OBJS) $(ALL)

OnlineEventBuilder.o : OnlineEventBuilder.cpp OnlineEventBuilder.h
		$(CC) $(COPTS) -c OnlineEventBuilder.cpp

MultiBuilder.o : MultiBuilder.cpp MultiBuilder.h
		$(CC) $(COPTS) -c MultiBuilder.cpp

ClassDigitizer.o : ClassDigitizer.cpp ClassDigitizer.h RegisterAddress.h macro.h ClassData.h
		$(CC) $(COPTS) -c ClassDigitizer.cpp

test	:	test.cpp ClassDigitizer.o OnlineEventBuilder.o
		@echo "--------- making test"
		$(CC) $(COPTS) -o test test.cpp ClassDigitizer.o  OnlineEventBuilder.o $(CAENLIBS)  $(ROOTLIBS)

test_indep : test_indep.cpp RegisterAddress.h macro.h
		@echo "--------- making test_indep"
		$(CC) $(COPTS) -o test_indep test_indep.cpp $(CAENLIBS) 

EventBuilder : EventBuilder.cpp ClassData.h
		@echo "--------- making EventBuilder"
		$(CC) $(COPTS) -o EventBuilder EventBuilder.cpp $(CAENLIBS) $(ROOTLIBS) 

DataGenerator : DataGenerator.cpp ClassDigitizer.o  OnlineEventBuilder.o
		@echo "--------- making DataGenerator"
		$(CC) $(COPTS) -o DataGenerator DataGenerator.cpp ClassDigitizer.o  OnlineEventBuilder.o $(CAENLIBS)

EventKenshikushi : EventKenshikushi.cpp ClassData.h MultiBuilder.o
		@echo "--------- making EventKenshikushi"
		$(CC) $(COPTS) -o EventKenshikushi EventKenshikushi.cpp MultiBuilder.o $(CAENLIBS) $(ROOTLIBS) 